<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸŒŠ PÃªcheurConnect</title>

  <!-- PWA -->
  <link rel="manifest" href="/sunu-blue-tech/manifest.json">
  <meta name="theme-color" content="#0B5ED7">
  <meta name="mobile-web-app-capable" content="yes">

  <!-- Icons -->
  <link rel="icon" href="/sunu-blue-tech/icon-192.png">

  <!-- Tailwind CDN (dev only, tu peux compiler pour prod) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    body { background:#020617; color:white; font-family:system-ui,sans-serif; margin:0; }
    header { text-align:center; padding:1rem; }
    #dashboard { max-width:600px; margin:auto; padding:1rem; }
    .card { background:rgba(15,23,42,0.8); padding:1rem; margin-bottom:1rem; border-radius:12px; border:1px solid rgba(51,65,85,0.4); }
    .danger { border:2px solid #ef4444; animation:pulse-red 2s infinite; }
    @keyframes pulse-red { 0% { box-shadow:0 0 0 0 rgba(239,68,68,0.6); } 70% { box-shadow:0 0 0 12px rgba(239,68,68,0); } 100% { box-shadow:0 0 0 0 rgba(239,68,68,0); } }
  </style>
</head>

<body>

<header>
  <h1 class="text-3xl font-black text-sky-400">ğŸŒŠ PÃªcheurConnect</h1>
  <p class="text-slate-400 text-xs uppercase">DonnÃ©es satellites temps rÃ©el</p>
</header>

<main id="dashboard">
  <p class="text-center text-slate-500 uppercase font-bold mt-10">Lecture des donnÃ©es satellites...</p>
</main>

<footer class="text-center text-slate-600 text-[9px] pb-10 uppercase font-bold tracking-widest">
  Â© 2026 PecheurConnect - Marine Data Senegal
</footer>

<script>
  const DATA_URL = "/sunu-blue-tech/data.json";

  async function updateDashboard() {
    const container = document.getElementById("dashboard");
    try {
      const res = await fetch(DATA_URL + "?t=" + Date.now());
      if(!res.ok) throw new Error();
      const data = await res.json();
      container.innerHTML = "";

      data.forEach(item => {
        const isDanger = item.houle >= 2.2;
        const card = document.createElement("div");
        card.className = "card " + (isDanger ? "danger" : "");
        card.innerHTML = `
          <h2 class="font-bold text-lg">${item.zone} ${isDanger ? "âš ï¸" : ""}</h2>
          <p>ğŸŒ¡ï¸ TempÃ©rature: <b>${item.sst}Â°C</b></p>
          <p>ğŸŒŠ Houle: <b>${item.houle}m</b></p>
          <p>ğŸŒ¬ï¸ Courant: <b>${item.courant}m/s</b></p>
        `;
        container.appendChild(card);
      });

    } catch(e) {
      container.innerHTML = '<p class="text-center text-red-500 mt-10 font-bold">Erreur lecture donnÃ©es</p>';
    }
  }

  window.onload = updateDashboard;

  // Service Worker
  if('serviceWorker' in navigator){
    navigator.serviceWorker.register("/sunu-blue-tech/sw.js")
      .then(()=>console.log("âœ… SW OK"))
      .catch(err=>console.error("âŒ SW erreur:", err));
  }
</script>

</body>
</html>
