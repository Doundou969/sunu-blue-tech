<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PecheurConnect - SÃ©nÃ©gal</title>
    <style>
        :root { --bg: #0f172a; --card: #1e293b; --accent: #38bdf8; --wa: #25D366; }
        body { font-family: system-ui, sans-serif; background: var(--bg); color: white; padding: 15px; }
        .card { background: var(--card); padding: 15px; border-radius: 12px; margin-bottom: 20px; border-left: 6px solid var(--accent); position: relative; }
        .gps { font-family: monospace; color: var(--accent); font-size: 0.8rem; margin: 5px 0; }
        .grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin: 12px 0; }
        .stat { background: rgba(0,0,0,0.3); padding: 8px; border-radius: 8px; text-align: center; }
        .val { display: block; font-weight: bold; font-size: 1.1rem; color: var(--accent); }
        .label { font-size: 0.6rem; opacity: 0.7; text-transform: uppercase; }
        .fish { background: #064e3b; padding: 10px; border-radius: 8px; font-size: 0.85rem; border: 1px solid #059669; }
        .actions { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px; }
        .btn { padding: 12px; border-radius: 8px; text-decoration: none; text-align: center; font-weight: bold; font-size: 0.8rem; }
        .btn-maps { background: white; color: black; }
        .btn-wa { background: var(--wa); color: white; }
        .status { text-align: center; font-size: 0.7rem; color: #94a3b8; margin-bottom: 20px; }
    </style>
</head>
<body>
    <h2 style="text-align:center; color: var(--accent);">âš“ PECHEUR CONNECT</h2>
    <div id="status" class="status">Chargement des satellites...</div>
    <div id="list"></div>

    <script>
        async function load() {
            try {
                const res = await fetch(`public/data.json?t=${Date.now()}`);
                const data = await res.json();
                const list = document.getElementById('list');
                list.innerHTML = '';
                
                data.forEach(item => {
                    // PrÃ©paration du message WhatsApp
                    const waMsg = encodeURIComponent(
                        `âš“ *PECHEUR CONNECT - INFOS MÃ‰TÃ‰O*\n` +
                        `ğŸ“ Zone: ${item.zone}\n` +
                        `ğŸŒŠ Vagues: ${item.vagues}m\n` +
                        `ğŸš© Courant: ${item.courant}\n` +
                        `ğŸŒ¡ï¸ Temp: ${item.temp}Â°C\n` +
                        `ğŸŸ Poissons: ${item.poissons}\n` +
                        `ğŸ“… ${item.date}`
                    );

                    list.innerHTML += `
                        <div class="card">
                            <div style="font-weight:bold; font-size:1.2rem">${item.zone}</div>
                            <div class="gps">ğŸ“ GPS: ${item.lat}, ${item.lon}</div>
                            <div class="grid">
                                <div class="stat"><span class="val">${item.vagues}m</span><span class="label">Vagues</span></div>
                                <div class="stat"><span class="val">${item.courant}</span><span class="label">Courant</span></div>
                                <div class="stat"><span class="val">${item.temp}Â°C</span><span class="label">Eau</span></div>
                            </div>
                            <div class="fish">ğŸŸ <b>Zones de pÃªche :</b><br>${item.poissons}</div>
                            <div class="actions">
                                <a href="https://www.google.com/maps?q=${item.lat},${item.lon}" class="btn btn-maps" target="_blank">CARTE GPS</a>
                                <a href="https://wa.me/?text=${waMsg}" class="btn btn-wa">PARTAGER</a>
                            </div>
                        </div>
                    `;
                });
                document.getElementById('status').innerText = `DerniÃ¨re synchro : ${data[0].date}`;
            } catch (e) {
                document.getElementById('status').innerText = "âŒ Erreur de connexion au serveur.";
            }
        }
        load();
    </script>
</body>
</html>
