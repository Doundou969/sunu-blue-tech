name: Rapport quotidien pÃªche ğŸ‡¸ğŸ‡³

on:
  schedule:
    - cron: '0 8 * * *'  # 8h UTC = 9h Dakar
  workflow_dispatch:

jobs:
  peche:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Configurer Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.11'
        
    - name: Installer dÃ©pendances
      run: pip install requests pandas beautifulsoup4 python-telegram-bot==20.7
      
    - name: ğŸ§ª TEST TELEGRAM DIRECT
      env:
        TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
        TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
      run: |
        echo "ğŸ” Token dÃ©tectÃ©: ${TELEGRAM_TOKEN:0:10}..."
        echo "ğŸ“± Chat ID: $TELEGRAM_CHAT_ID"
        curl -s -X POST "https://api.telegram.org/bot$TELEGRAM_TOKEN/sendMessage" \
          -d chat_id="$TELEGRAM_CHAT_ID" \
          -d "text=ğŸ£ *TEST URGENT SUNU-BLUE-TECH* âœ… 22 Jan 2026\nğŸ“Š Workflow OK!" \
          -d parse_mode=Markdown || echo "âŒ Erreur Telegram"
          
    - name: Lancer script pÃªche
      env:
        TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
        TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
      run: python script_peche.py
